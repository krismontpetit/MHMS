###############################################################################
#                                                                             #
# IAR C/C++ Compiler V5.51.2.50607/W32 for MSP430       26/Apr/2013  12:56:17 #
# Copyright 1996-2012 IAR Systems AB.                                         #
#                                                                             #
#    __rt_version  =  3                                                       #
#    __double_size =  32                                                      #
#    __reg_r4      =  free                                                    #
#    __reg_r5      =  free                                                    #
#    __pic         =  no                                                      #
#    __core        =  430X                                                    #
#    __data_model  =  small                                                   #
#    Source file   =  C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1 #
#                     \Projects\zstack\ZAP\TVSA\Source\tvsa_cc2530znp.c       #
#    Command line  =  -f C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2. #
#                     5.1\Projects\zstack\ZAP\TVSA\EXP5438\..\..\Source\zap.c #
#                     fg (-DTVSA_DEVICE_ID=0x0016 -DTVSA_DONGLE=1             #
#                     -DHAL_UART=1 -DZAP_PHY_SPI=1                            #
#                     -DZAP_PHY_UART=!ZAP_PHY_SPI -DZAP_PHY_RESET_ZNP=TRUE    #
#                     -DZAP_ZNP_MT=FALSE -DZAP_APP_MSG=FALSE                  #
#                     -DZAP_SBL_PROXY=FALSE -DZAP_AUTO_CFG=TRUE               #
#                     -DZAP_AUTO_START=TRUE -DZAP_NV_RESTORE=FALSE            #
#                     -DLCD_SUPPORTED -DZAP_AF_DATA_REQ_FRAG=FALSE            #
#                     -DZAP_AF_DATA_REQ_AREQ=!ZAP_AF_DATA_REQ_FRAG            #
#                     -DZAP_ZDO_STARTUP_AREQ=TRUE -DZAP_AF_FUNC               #
#                     -DZAP_SAPI_FUNC -DZAP_SYS_FUNC -DZAP_UTIL_FUNC          #
#                     -DZAP_ZDO_FUNC -DSECURE=0 -DZG_SECURE_DYNAMIC=0         #
#                     "-DDEFAULT_CHANLIST=(uint32)0x00000800"                 #
#                     -DZDAPP_CONFIG_PAN_ID=0xFFFF -DPOLL_RATE=1000           #
#                     -DNWK_START_DELAY=100 -DMAX_BINDING_CLUSTER_IDS=4)      #
#                     C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1 #
#                     \Projects\zstack\ZAP\TVSA\Source\tvsa_cc2530znp.c -D    #
#                     ZAP_DEVICETYPE=ZG_DEVICETYPE_COORDINATOR -D             #
#                     TVSA_DEVICE_ID=0x0016 -D TVSA_DONGLE=1 -D HAL_UART=1    #
#                     -lC "C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430- #
#                     2.5.1\Projects\zstack\ZAP\TVSA\EXP5438\ZAP              #
#                     Coordinator\List\" -lA "C:\Users\student\Documents\GitH #
#                     ub\MHMS\ZAP-MSP430-2.5.1\Projects\zstack\ZAP\TVSA\EXP54 #
#                     38\ZAP Coordinator\List\" --remarks --diag_suppress     #
#                     Pe001,Pe193,Pe236,Pe826 -o                              #
#                     "C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5. #
#                     1\Projects\zstack\ZAP\TVSA\EXP5438\ZAP                  #
#                     Coordinator\Obj\" --debug -D__MSP430F5438A__ -e         #
#                     --double=32 --clib -I C:\Users\student\Documents\GitHub #
#                     \MHMS\ZAP-MSP430-2.5.1\Projects\zstack\ZAP\TVSA\EXP5438 #
#                     \ -I C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430- #
#                     2.5.1\Projects\zstack\ZAP\TVSA\EXP5438\..\Source\ -I    #
#                     C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1 #
#                     \Projects\zstack\ZAP\TVSA\EXP5438\..\..\Source\ -I      #
#                     C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1 #
#                     \Projects\zstack\ZAP\TVSA\EXP5438\..\..\..\..\..\Compon #
#                     ents\hal\target\MSP5438ZAP\ -I                          #
#                     C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1 #
#                     \Projects\zstack\ZAP\TVSA\EXP5438\..\..\..\..\..\Compon #
#                     ents\hal\include\ -I C:\Users\student\Documents\GitHub\ #
#                     MHMS\ZAP-MSP430-2.5.1\Projects\zstack\ZAP\TVSA\EXP5438\ #
#                     ..\..\..\..\..\Components\mac\include\ -I               #
#                     C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1 #
#                     \Projects\zstack\ZAP\TVSA\EXP5438\..\..\..\..\..\Compon #
#                     ents\mt\ -I C:\Users\student\Documents\GitHub\MHMS\ZAP- #
#                     MSP430-2.5.1\Projects\zstack\ZAP\TVSA\EXP5438\..\..\..\ #
#                     ..\..\Components\osal\include\ -I                       #
#                     C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1 #
#                     \Projects\zstack\ZAP\TVSA\EXP5438\..\..\..\..\..\Compon #
#                     ents\osal\mcu\msp430\ -I C:\Users\student\Documents\Git #
#                     Hub\MHMS\ZAP-MSP430-2.5.1\Projects\zstack\ZAP\TVSA\EXP5 #
#                     438\..\..\..\..\..\Components\services\saddr\ -I        #
#                     C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1 #
#                     \Projects\zstack\ZAP\TVSA\EXP5438\..\..\..\..\..\Compon #
#                     ents\services\sdata\ -I C:\Users\student\Documents\GitH #
#                     ub\MHMS\ZAP-MSP430-2.5.1\Projects\zstack\ZAP\TVSA\EXP54 #
#                     38\..\..\..\..\..\Components\stack\af\ -I               #
#                     C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1 #
#                     \Projects\zstack\ZAP\TVSA\EXP5438\..\..\..\..\..\Compon #
#                     ents\stack\nwk\ -I C:\Users\student\Documents\GitHub\MH #
#                     MS\ZAP-MSP430-2.5.1\Projects\zstack\ZAP\TVSA\EXP5438\.. #
#                     \..\..\..\..\Components\stack\sapi\ -I                  #
#                     C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1 #
#                     \Projects\zstack\ZAP\TVSA\EXP5438\..\..\..\..\..\Compon #
#                     ents\stack\sec\ -I C:\Users\student\Documents\GitHub\MH #
#                     MS\ZAP-MSP430-2.5.1\Projects\zstack\ZAP\TVSA\EXP5438\.. #
#                     \..\..\..\..\Components\stack\sys\ -I                   #
#                     C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1 #
#                     \Projects\zstack\ZAP\TVSA\EXP5438\..\..\..\..\..\Compon #
#                     ents\stack\zdo\ -I C:\Users\student\Documents\GitHub\MH #
#                     MS\ZAP-MSP430-2.5.1\Projects\zstack\ZAP\TVSA\EXP5438\.. #
#                     \..\..\..\..\Components\zmac\ -I                        #
#                     C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1 #
#                     \Projects\zstack\ZAP\TVSA\EXP5438\..\..\..\..\..\Compon #
#                     ents\zmac\f8w\ --core=430X --data_model=small -Ohz      #
#                     --multiplier=32 --multiplier_location=4C0               #
#                     --require_prototypes --hw_workaround=CPU40              #
#                     --hw_workaround=CPU42                                   #
#    List file     =  C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1 #
#                     \Projects\zstack\ZAP\TVSA\EXP5438\ZAP                   #
#                     Coordinator\List\tvsa_cc2530znp.lst                     #
#    Object file   =  C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1 #
#                     \Projects\zstack\ZAP\TVSA\EXP5438\ZAP                   #
#                     Coordinator\Obj\tvsa_cc2530znp.r43                      #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1\Projects\zstack\ZAP\TVSA\Source\tvsa_cc2530znp.c
      1          /**************************************************************************************************
      2              Filename:       tvsa_cc2530znp.c
      3              Revised:        $Date: 2011-07-25 20:23:05 -0700 (Mon, 25 Jul 2011) $
      4              Revision:       $Revision: 26899 $
      5          
      6              Description:
      7          
      8              This file implements the CC2530ZNP board-specific Temperature/Voltage calculations.
      9          
     10              Copyright 2009 Texas Instruments Incorporated. All rights reserved.
     11          
     12              IMPORTANT: Your use of this Software is limited to those specific rights
     13              granted under the terms of a software license agreement between the user
     14              who downloaded the software, his/her employer (which must be your employer)
     15              and Texas Instruments Incorporated (the "License").  You may not use this
     16              Software unless you agree to abide by the terms of the License. The License
     17              limits your use, and you acknowledge, that the Software may not be modified,
     18              copied or distributed unless embedded on a Texas Instruments microcontroller
     19              or used solely and exclusively in conjunction with a Texas Instruments radio
     20              frequency transceiver, which is integrated into your product.  Other than for
     21              the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     22              works of, modify, distribute, perform, display or sell this Software and/or
     23              its documentation for any purpose.
     24          
     25              YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     26              PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     27              INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     28              NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     29              TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     30              NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     31              LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     32              INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     33              OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     34              OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     35              (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     36          
     37              Should you have any questions regarding your right to use this Software,
     38              contact Texas Instruments Incorporated at www.TI.com.
     39          **************************************************************************************************/
     40          
     41          /* ------------------------------------------------------------------------------------------------
     42           *                                          Includes
     43           * ------------------------------------------------------------------------------------------------
     44           */
     45          
     46          #include "hal_adc.h"
     47          #include "mt.h"
     48          #include "tvsa.h"
     49          #include "zap_app.h"
     50          #include "ZComDef.h"
     51          
     52          /* ------------------------------------------------------------------------------------------------
     53           *                                           Constants
     54           * ------------------------------------------------------------------------------------------------
     55           */
     56          
     57          /*
     58           * These parameters are typical values and need to be calibrated
     59           * See the datasheet for the appropriate chip for more details
     60           * also, the math below may not be very accurate
     61           */
     62          /* Assume ADC = 1480 at 25C and ADC = 4/C */
     63          //#define VOLTAGE_AT_TEMP_25        1480
     64          #define VOLTAGE_AT_TEMP_22        1468
     65          #define TEMP_COEFFICIENT          4
     66          
     67          #define HAL_ADC_REF_125V    0x00    /* Internal 1.25V Reference */
     68          #define HAL_ADC_DEC_512     0x30    /* Decimate by 512 : 14-bit resolution */
     69          #define HAL_ADC_CHN_TEMP    0x0e    /* Temperature sensor */
     70          
     71          /* ------------------------------------------------------------------------------------------------
     72           *                                           Typedefs
     73           * ------------------------------------------------------------------------------------------------
     74           */
     75          
     76          /* ------------------------------------------------------------------------------------------------
     77           *                                           Macros
     78           * ------------------------------------------------------------------------------------------------
     79           */
     80          
     81          #define degC_0       (voltageAtTemp22 - (22 * TEMP_COEFFICIENT))
     82          #define degC_100     (voltageAtTemp22 + (78 * TEMP_COEFFICIENT))
     83          
     84          /* ------------------------------------------------------------------------------------------------
     85           *                                           Global Variables
     86           * ------------------------------------------------------------------------------------------------
     87           */
     88          
     89          /* ------------------------------------------------------------------------------------------------
     90           *                                           Local Variables
     91           * ------------------------------------------------------------------------------------------------
     92           */
     93          
     94          static uint16 voltageAtTemp22;
     95          
     96          /* ------------------------------------------------------------------------------------------------
     97           *                                           Local Functions
     98           * ------------------------------------------------------------------------------------------------
     99           */
    100          
    101          static void HalInitTV(void);
    102          static void HalCalcTV(uint8 *tvDat);
    103          
    104          /**************************************************************************************************
    105           * @fn          HalInitTV
    106           *
    107           * @brief       This function is called by tvsaAppInit() to calibrate to the assumed room temp
    108           *              of 22 degC.
    109           *
    110           * input parameters
    111           *
    112           * None.
    113           *
    114           * output parameters
    115           *
    116           * None.
    117           *
    118           * @return      None.
    119           **************************************************************************************************
    120           */
    121          static void HalInitTV(void)
    122          {
    123            uint8 calDat[TVSA_DAT_LEN];
                                ^
Error[Pe020]: identifier "TVSA_DAT_LEN" is undefined
    124          
    125            voltageAtTemp22 = VOLTAGE_AT_TEMP_22;
    126            HalCalcTV(calDat);
    127          
    128            if (22 > calDat[TVSA_TEM_IDX])
                                   ^
Error[Pe020]: identifier "TVSA_TEM_IDX" is undefined
    129            {
    130              voltageAtTemp22 -= (22 - calDat[TVSA_TEM_IDX]) * TEMP_COEFFICIENT;
    131            }
    132            else if (22 < calDat[TVSA_TEM_IDX])
    133            {
    134              voltageAtTemp22 += (calDat[TVSA_TEM_IDX] - 22) * TEMP_COEFFICIENT;
    135            }
    136          }
    137          
    138          /**************************************************************************************************
    139           * @fn          HalCalcTV
    140           *
    141           * @brief       This function is called by tvsaDataCalc() to calculate the board-specific data
    142           *              for a TVSA report.
    143           *
    144           * input parameters
    145           *
    146           * None.
    147           *
    148           * output parameters
    149           *
    150           * None.
    151           *
    152           * @return      None.
    153           **************************************************************************************************
    154           */
    155          static void HalCalcTV(uint8 *tvDat)
    156          {
    157            uint16 tmp;
    158            uint8 args[2];
    159          
    160            args[0] = HAL_ADC_CHANNEL_TEMP;
    161            args[1] = HAL_ADC_RESOLUTION_14;
    162          
    163            zapSysReq(MT_SYS_ADC_READ, (uint8 *)&tmp, args);
    164            tmp >>= 4;  // Use the 12 MSB of adcValue.
    165          
    166            if (tmp < degC_0)
    167            {
    168              tmp = degC_0;
    169            }
    170            else if (tmp > degC_100)
    171            {
    172              tmp = degC_100;
    173            }
    174            
    175            tvDat[TVSA_TEM_IDX] = (uint8)((tmp - degC_0 + TEMP_COEFFICIENT-1) / TEMP_COEFFICIENT);
                         ^
Error[Pe020]: identifier "TVSA_TEM_IDX" is undefined
    176          
    177            args[0] = HAL_ADC_CHANNEL_VDD;
    178          
    179            zapSysReq(MT_SYS_ADC_READ, (uint8 *)&tmp, args);
    180            tmp >>= 4;  // Use the 12 MSB of adcValue.
    181          
    182            // Calculate the Vdd measured in 10ths of V.
    183            // ADC * 3.75 / 2047 * 10
    184            tmp *= 5;
    185            tmp /= 273;
    186          
    187            tvDat[TVSA_BUS_IDX] = (uint8)tmp;
                         ^
Error[Pe020]: identifier "TVSA_BUS_IDX" is undefined

  static void HalInitTV(void)
              ^
"C:\Users\student\Documents\GitHub\MHMS\ZAP-MSP430-2.5.1\Projects\zstack\ZAP\TVSA\Source\tvsa_cc2530znp.c",121  Warning[Pe177]: 
          function "HalInitTV" was declared but never referenced
    188          }
    189          
    190          /**************************************************************************************************
    191          */

Errors: 4
Warnings: 1
